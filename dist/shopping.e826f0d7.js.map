{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,wEAQA,MAAMC,EAAcC,SAASC,eAAe,QACtCC,EAAeF,SAASC,eAAe,SACvCE,EAAcH,SAASC,eAAe,gBAE5C,IACIG,EADAC,EAAO,GAGX,SAASC,EAASC,GAEd,IAAIC,EAAQ,EACZD,EAAKE,SAAQC,KA0BjB,SAAuBA,GACnB,MAAMC,EAAcX,SAASY,cAAc,MAE3CD,EAAYE,UAAY,UACxBF,EAAYG,UAAY,qBAEZJ,EAAQK,6DACOL,EAAQM,kDACDC,EAAAC,eAAeR,EAAQS,UAAUT,EAAQU,wFAI3ErB,EAAYsB,YAAYV,GAIxBA,EAAYW,iBAAiB,SAASC,IACT,WAArBA,EAAEC,OAAOC,UACTC,QAAQC,IAAI,cAnCxBC,eAA6BC,GACzB,MAAMC,EAAUzB,EAAK0B,QAAOrB,GAAWA,EAAQsB,KAAOH,IAEtDxB,EAAOyB,EAEH1B,SACM6B,EAAAC,mBAAmBrC,EAAAsC,GAAI/B,EAAWgC,IAAKN,GAGjDb,EAAAoB,iBAAiBP,GAEjB/B,EAAYe,UAAY,GAExBR,EAASwB,GAuBDQ,CAAc5B,EAAQsB,QA5C1BO,CAAc7B,GACdF,GAASgC,SAAS9B,EAAQS,UAG9BjB,EAAauC,UAAY,kBAAoBxB,EAAAC,eAAeV,GA6ChEL,EAAYmB,iBAAiB,SAASC,IAClCmB,OAAOC,SAASC,KAAQ,qBAG5BC,EAAAC,mBAAmBjD,EAAAkD,MAAMnB,MAAOoB,IAExBA,GAEA5C,EAAa4C,EACb3C,QAAa4B,EAAAgB,gBAAgBpD,EAAAsC,GAAI/B,EAAWgC,MAG5C/B,EAAOY,EAAAiC,iBAIX5C,EAASD","sources":["src/shopping.js"],"sourcesContent":["import { db, auth } from '../src/functions/app';\nimport { onAuthStateChanged } from \"firebase/auth\";\nimport { getFirebaseCart, createFirebaseCart } from \"./functions/cart\";\nimport { addProductToCart } from \"../utils/index\";\nimport { getMyLocalCart, currencyFormat } from \"../utils/index\";\nimport { doc } from 'firebase/firestore';\n\n\nconst cartSection = document.getElementById(\"cart\");\nconst totalSection = document.getElementById(\"total\");\nconst shoppingBtn = document.getElementById(\"shopping_btn\");\n\nlet cart = [];\nlet userLogged = undefined;\n\nfunction loadCart(cart) {\n\n    let total = 0;\n    cart.forEach(product => {\n        renderProduct(product);\n        total += parseInt(product.price);\n    });\n\n    totalSection.innerText = \"Total a pagar: \" + currencyFormat(total);\n    \n};\n\nasync function removeProduct(productId) {\n    const newCart = cart.filter(product => product.id !== productId);\n\n    cart = newCart;\n\n    if (userLogged) {\n        await createFirebaseCart(db, userLogged.uid, newCart);\n    }\n\n    addProductToCart(newCart);\n\n    cartSection.innerHTML = \"\";\n\n    loadCart(newCart);\n}\n\n\nfunction renderProduct(product) {\n    const productCart = document.createElement(\"li\");\n\n    productCart.className = \"product\";\n    productCart.innerHTML = `\n\n    <img src=\"${product.img}\" class=\"product_image\">\n    <h2 class=\"product_name\">${product.name}</h2>\n    <h3 class=\"product_description\">${currencyFormat(product.price)} ${product.description}</h3>\n    <button class=\"product_delete\">Eliminar producto</button>\n    `;\n\n    cartSection.appendChild(productCart);\n    \n\n   \n    productCart.addEventListener(\"click\", e => {\n        if (e.target.tagName === \"BUTTON\") {\n            console.log(\"remove it!\");\n            removeProduct(product.id);\n        }\n   })\n};\n\nshoppingBtn.addEventListener(\"click\", e => {\n    window.location.href = (\"./checkout.html\");\n})\n\nonAuthStateChanged(auth, async (user) => {\n    \n    if (user) {\n\n        userLogged = user;\n        cart = await getFirebaseCart(db, userLogged.uid);\n\n    } else {\n        cart = getMyLocalCart();\n\n    }\n\n    loadCart(cart);\n\n});"],"names":["$4Bu0d","parcelRequire","$679f288ffe2eca98$var$cartSection","document","getElementById","$679f288ffe2eca98$var$totalSection","$679f288ffe2eca98$var$shoppingBtn","$679f288ffe2eca98$var$userLogged","$679f288ffe2eca98$var$cart","$679f288ffe2eca98$var$loadCart","cart","total","forEach","product","productCart","createElement","className","innerHTML","img","name","$aDR0T","currencyFormat","price","description","appendChild","addEventListener","e","target","tagName","console","log","async","productId","newCart","filter","id","$6naOk","createFirebaseCart","db","uid","addProductToCart","$679f288ffe2eca98$var$removeProduct","$679f288ffe2eca98$var$renderProduct","parseInt","innerText","window","location","href","$1tHc5","onAuthStateChanged","auth","user","getFirebaseCart","getMyLocalCart"],"version":3,"file":"shopping.e826f0d7.js.map"}