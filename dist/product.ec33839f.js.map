{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,6DAMA,MAAMC,EAAqBC,SAASC,eAAe,eAC7CC,EAAuBF,SAASC,eAAe,iBAC/CE,EAASH,SAASC,eAAe,OAGvC,IAAIG,EACAC,EAAO,GASXC,eAAeC,IACX,MAAMC,EARV,SAAkBC,GACd,MAAMC,EAAMC,OAAOC,SAASC,OAG5B,OAFqB,IAAIC,gBAAgBJ,GACVK,IAAIN,GAKjBO,CAAS,MACrBC,EAASC,EAAAC,IAAItB,EAAAuB,GAAI,WAAYZ,IAavC,SAAuBa,GAEnBnB,EAAqBoB,UAAY,uDAAuDD,EAAQE,IAAI,OAEpG,MACMC,EADuBnB,EAAKoB,MAAMC,GAAgBA,EAAYC,KAAON,EAAQM,KAE/E,mEAAkE,0DAGrE5B,EAAkBuB,UAAY,yEAEHD,EAAQO,wDACIC,EAAAC,eAAeT,EAAQU,UAAUV,EAAQW,gEACvCX,EAAQY,2DACVZ,EAAUa,mBAChDV,sBAIF,MAAMW,EAAmBnC,SAASoC,cAAc,iBAChDD,EAAiBE,iBAAiB,SAAUC,IACxCjC,EAAKkC,KAAKlB,GACVQ,EAAAW,iBAAiBnC,GAEbD,GACAqC,EAAAC,mBAAmB7C,EAAAuB,GAAGhB,EAAWuC,IAAItC,GAGzC8B,EAAiBS,aAAa,YAAY,GAC1CT,EAAiBU,UAAY,sBAjCjCC,CALgB,WAHM5B,EAAA6B,OAAO9B,IACR+B,OAIjBrB,GAAInB,IA0CZL,EAAOkC,iBAAiB,SAAUC,IAC/B3B,OAAOC,SAASqC,KAAQ,kBAI3BC,EAAAC,mBAAmBtD,EAAAuD,MAAM9C,MAAO+C,IAExBA,GAEAjD,EAAaiD,EACbhD,QAAaoC,EAAAa,gBAAgBzD,EAAAuB,GAAIhB,EAAWuC,MAG5CtC,EAAOwB,EAAA0B,iBAIXhD","sources":["src/product.js"],"sourcesContent":["import { db, auth } from '../src/functions/app'\nimport { doc, getDoc } from \"firebase/firestore\";\nimport { onAuthStateChanged } from 'firebase/auth';\nimport { getFirebaseCart, createFirebaseCart} from '../src/functions/cart';\nimport { getMyLocalCart, addProductToCart, currencyFormat } from '../utils';\n\nconst productInfoSection = document.getElementById(\"productInfo\");\nconst productAssetsSection = document.getElementById(\"productAssets\");\nconst btnBuy = document.getElementById(\"btn\");\n\n\nlet userLogged = undefined;\nlet cart = [];\n\nfunction getParam(param) {\n    const url = window.location.search;\n    const searchParams = new URLSearchParams(url);\n    const productId = searchParams.get(param);\n    return productId;\n}\n\nasync function getProduct() {\n    const productId = getParam(\"id\");\n    const docRef = doc(db, \"products\", productId);\n    const docSnap = await getDoc(docRef);\n    const data = docSnap.data();\n\n    const product = {\n        ...data,\n        id: productId,\n    }\n\n    renderProduct(product);\n\n}\n\nfunction renderProduct(product) {\n\n    productAssetsSection.innerHTML = `<img class=\"product__mainImage\" id=\"mainImage\" src=\"${product.img[0]}\">`;\n\n    const isProductAddedToCart = cart.some((productCart) => productCart.id === product.id);\n    const productButtonCart = isProductAddedToCart ?\n        '<button class=\"product_cart\" disabled>Producto añadido</button >' :\n        '<button class=\"product_cart\">Añadir al carrito</button>';\n\n    productInfoSection.innerHTML = `\n    <div class=\"product__container\">\n    <h1 class=\"product__name\">${product.name}</h1>\n    <p class=\"product__description color\">${currencyFormat(product.price)} ${product.description}</p>\n    <p class=\"product__description\">Vegano: ${product.vegano}</p>\n    <p class=\"product__description\">Azúcar: ${product.azucar}</p>\n    ${productButtonCart}\n    </div>\n    `;\n\n    const productCartButon = document.querySelector(\".product_cart\");\n    productCartButon.addEventListener(\"click\", (e) => {\n        cart.push(product);\n        addProductToCart(cart);\n\n        if (userLogged) {\n            createFirebaseCart(db,userLogged.uid,cart);\n        }\n \n        productCartButon.setAttribute(\"disabled\", true);\n        productCartButon.innerText = \"Producto añadido\";\n    });\n\n    // console.log(product);\n}\n\nbtnBuy.addEventListener(\"click\", (e) => {\n   window.location.href = (\"./index.html\");\n});\n\n\nonAuthStateChanged(auth, async (user) => {\n    //console.log(user);\n    if (user) {\n\n        userLogged = user;\n        cart = await getFirebaseCart(db, userLogged.uid);\n        // console.log(cart);\n    } else {\n        cart = getMyLocalCart();\n\n    }\n\n    getProduct();\n});\n\n"],"names":["$4Bu0d","parcelRequire","$4561a5f183cf30d8$var$productInfoSection","document","getElementById","$4561a5f183cf30d8$var$productAssetsSection","$4561a5f183cf30d8$var$btnBuy","$4561a5f183cf30d8$var$userLogged","$4561a5f183cf30d8$var$cart","async","$4561a5f183cf30d8$var$getProduct","productId","param","url","window","location","search","URLSearchParams","get","$4561a5f183cf30d8$var$getParam","docRef","$etBjH","doc","db","product","innerHTML","img","productButtonCart","some","productCart","id","name","$aDR0T","currencyFormat","price","description","vegano","azucar","productCartButon","querySelector","addEventListener","e","push","addProductToCart","$6naOk","createFirebaseCart","uid","setAttribute","innerText","$4561a5f183cf30d8$var$renderProduct","getDoc","data","href","$1tHc5","onAuthStateChanged","auth","user","getFirebaseCart","getMyLocalCart"],"version":3,"file":"product.ec33839f.js.map"}